# 에이전트 (Agents)

에이전트는 LLM이 도구를 사용하여 복잡한 작업을 수행할 수 있게 해주는 핵심 개념입니다. 이 섹션에서는 에이전트의 개념과 ReAct 패턴에 대해 자세히 알아봅니다.

## 에이전트란?

에이전트는 **자율적으로 행동하는 AI 시스템**입니다. 사용자의 요청을 받아, 필요한 도구를 선택하고 실행하며, 결과를 바탕으로 최종 답변을 생성합니다. 에이전트는 단순히 텍스트를 생성하는 것이 아니라, **도구를 사용하여 실제 작업을 수행**할 수 있습니다.

## 에이전트의 동작 원리

에이전트는 다음과 같은 순환 루프를 따릅니다:

1. **사용자 입력 수신**: 사용자의 질문이나 요청을 받습니다.
2. **추론 (Reasoning)**: LLM이 현재 상황을 분석하고 다음에 무엇을 해야 할지 결정합니다.
3. **도구 선택**: 필요한 도구를 선택하고 호출합니다.
4. **도구 실행**: 선택된 도구를 실행하고 결과를 받습니다.
5. **결과 분석**: 도구 실행 결과를 분석합니다.
6. **반복 또는 종료**: 더 많은 정보가 필요하면 2단계로 돌아가고, 충분한 정보를 얻었으면 최종 답변을 생성합니다.

## ReAct 패턴

ReAct는 **Reasoning + Acting**의 약자로, 에이전트가 추론과 행동을 번갈아가며 수행하는 패턴입니다.

### ReAct 패턴의 특징

- **추론 (Reasoning)**: "왜 이 도구를 사용해야 하는가?"를 생각합니다.
- **행동 (Acting)**: 실제로 도구를 호출하고 실행합니다.
- **관찰 (Observation)**: 도구 실행 결과를 관찰하고 분석합니다.

### ReAct 패턴 예제

```
사용자: "서울의 날씨를 알려주고, 그 온도에 맞는 옷차림을 추천해주세요."

에이전트의 생각:
1. 먼저 서울의 날씨 정보를 가져와야 합니다.
2. 날씨 도구를 호출합니다.
3. 결과: 서울의 날씨는 15도, 맑음
4. 이 온도에 맞는 옷차림을 추천합니다.
5. 최종 답변 생성
```

## create_agent 사용법

LangChain v1.0에서는 `create_agent`를 사용하여 에이전트를 쉽게 만들 수 있습니다.

### 기본 사용법

```python
from langchain.agents import create_agent
from langchain_openai import ChatOpenAI
from langchain.tools import tool

# 도구 정의
@tool
def search_web(query: str) -> str:
    """웹 검색을 수행합니다."""
    # 실제로는 웹 검색 API를 호출
    return f"'{query}'에 대한 검색 결과..."

# 모델 초기화
model = ChatOpenAI(model="gpt-3.5-turbo")

# 에이전트 생성
agent = create_agent(
    model=model,
    tools=[search_web],
    system_prompt="당신은 유용한 정보를 제공하는 어시스턴트입니다."
)

# 에이전트 실행
response = agent.invoke({
    "messages": [{"role": "user", "content": "최신 AI 뉴스를 검색해주세요."}]
})
```

### 커스텀 시스템 프롬프

에이전트의 동작을 제어하기 위해 시스템 프롬프를 커스터마이징할 수 있습니다:

```python
agent = create_agent(
    model=model,
    tools=[search_web, calculate],
    system_prompt=(
        "당신은 정확하고 신뢰할 수 있는 정보를 제공하는 어시스턴트입니다. "
        "불확실한 정보는 추측하지 말고, 도구를 사용하여 정확한 정보를 찾아주세요."
    )
)
```

## 에이전트의 장점

1. **자율성**: 사용자의 요청을 받아 자동으로 필요한 도구를 선택하고 실행합니다.
2. **확장성**: 새로운 도구를 추가하기만 하면 에이전트의 기능을 확장할 수 있습니다.
3. **유연성**: 다양한 작업을 수행할 수 있는 범용적인 시스템을 구축할 수 있습니다.
4. **투명성**: 에이전트가 어떤 도구를 사용했는지 추적할 수 있습니다.

## 에이전트의 한계

1. **비용**: 여러 번의 LLM 호출이 필요하므로 비용이 증가할 수 있습니다.
2. **지연 시간**: 도구 실행과 여러 번의 LLM 호출로 인해 응답 시간이 길어질 수 있습니다.
3. **오류 처리**: 도구 실행 중 오류가 발생할 수 있으며, 이를 적절히 처리해야 합니다.

## 다음 단계

이제 에이전트의 기본 개념을 이해했으니, 다음 섹션에서 RAG(Retrieval Augmented Generation)를 사용하여 에이전트를 더욱 강력하게 만드는 방법을 알아보겠습니다.

